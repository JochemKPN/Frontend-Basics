define("@ta/social.follow",["@ta/overlays.toast","@ta/social.blocks","@ta/social.button","@ta/social.feed","@ta/social.login-gate","@ta/social.onboarding-state","@ta/tracking.interactions","@ta/common.global"],function(e,o,t,n,l,a,i,r){return function(e){var o={};function t(n){if(o[n])return o[n].exports;var l=o[n]={i:n,l:!1,exports:{}};return e[n].call(l.exports,l,l.exports,t),l.l=!0,l.exports}return t.m=e,t.c=o,t.d=function(e,o,n){t.o(e,o)||Object.defineProperty(e,o,{enumerable:!0,get:n})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,o){if(1&o&&(e=t(e)),8&o)return e;if(4&o&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&o&&"string"!=typeof e)for(var l in e)t.d(n,l,function(o){return e[o]}.bind(null,l));return n},t.n=function(e){var o=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(o,"a",o),o},t.o=function(e,o){return Object.prototype.hasOwnProperty.call(e,o)},t.p="/components/dist/",t(t.s="./packages/social/follow/FollowButton.jsx")}({"./node_modules/react-apollo/react-apollo.browser.umd.js":function(e,o,t){e.exports=t("dll-reference @ta/common.global")("./node_modules/react-apollo/react-apollo.browser.umd.js")},"./node_modules/react-redux/es/index.js":function(e,o,t){e.exports=t("dll-reference @ta/common.global")("./node_modules/react-redux/es/index.js")},"./node_modules/react/index.js":function(e,o,t){e.exports=t("dll-reference @ta/common.global")("./node_modules/react/index.js")},"./packages/common/classnames/classnames.jsx":function(e,o,t){"use strict";t.d(o,"a",function(){return l}),t.d(o,"b",function(){return a});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function l(){for(var e=[],o=arguments.length,t=Array(o),a=0;a<o;a++)t[a]=arguments[a];for(var i=function(o){var a=t[o];if(a){var i=void 0===a?"undefined":n(a);"string"===i||"number"===i?e.push(a):Array.isArray(a)?e.push(l.apply(void 0,function(e){if(Array.isArray(e)){for(var o=0,t=Array(e.length);o<e.length;o++)t[o]=e[o];return t}return Array.from(e)}(a))):"object"===i&&Object.keys(a).filter(function(e){return a[e]}).forEach(function(o){return e.push(o)})}},r=0;r<t.length;r++)i(r);return e.join(" ")}function a(e,o,t){var n=e.split(" ").filter(function(e){return e!==o});return t&&n.push(t),n}},"./packages/common/features/features.jsx":function(e,o,t){e.exports=t("dll-reference @ta/common.global")("./packages/common/features/features.jsx")},"./packages/common/i18n/i18n.jsx":function(e,o,t){e.exports=t("dll-reference @ta/common.global")("./packages/common/i18n/i18n.jsx")},"./packages/common/text/EscapeHtml.jsx":function(e,o,t){"use strict";o.a=function(e){return e?e.replace(/[<>&"'`]/g,function(e){return{"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;","'":"&#39;","`":"&#x60;"}[e]}):""}},"./packages/social/follow/AddFollow.gql":function(e,o){var t={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"Follow"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"objectId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"objectType"}},type:{kind:"NamedType",name:{kind:"Name",value:"SocialObjectTypeInput"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"addFollow"},name:{kind:"Name",value:"addFollowV2"},arguments:[{kind:"Argument",name:{kind:"Name",value:"socialObject"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"objectType"},value:{kind:"Variable",name:{kind:"Name",value:"objectType"}}},{kind:"ObjectField",name:{kind:"Name",value:"objectId"},value:{kind:"Variable",name:{kind:"Name",value:"objectId"}}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"statusType"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:185}};t.loc.source={body:"mutation Follow($objectId: String, $objectType: SocialObjectTypeInput) {\n  addFollow: addFollowV2(socialObject: { objectType: $objectType, objectId: $objectId }) {\n    statusType\n  }\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};e.exports=t},"./packages/social/follow/DeleteFollow.gql":function(e,o){var t={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"deleteFollow"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"objectId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"objectType"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"SocialObjectTypeInput"}}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"deleteFollow"},name:{kind:"Name",value:"deleteFollowV2"},arguments:[{kind:"Argument",name:{kind:"Name",value:"socialObject"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"objectType"},value:{kind:"Variable",name:{kind:"Name",value:"objectType"}}},{kind:"ObjectField",name:{kind:"Name",value:"objectId"},value:{kind:"Variable",name:{kind:"Name",value:"objectId"}}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"statusType"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:198}};t.loc.source={body:"mutation deleteFollow($objectId: String, $objectType: SocialObjectTypeInput!) {\n  deleteFollow: deleteFollowV2(socialObject: { objectType: $objectType, objectId: $objectId }) {\n    statusType\n  }\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};e.exports=t},"./packages/social/follow/FollowButton.jsx":function(e,o,t){"use strict";t.r(o);var n=t("./node_modules/react/index.js"),l=t("./node_modules/react-apollo/react-apollo.browser.umd.js"),a=t("./node_modules/react-redux/es/index.js"),i=t("./packages/common/classnames/classnames.jsx"),r=t("./packages/common/text/EscapeHtml.jsx"),c=t("./packages/common/features/features.jsx"),s=t("./packages/common/i18n/i18n.jsx"),u=t("./packages/styleguide/icon/Icon.jsx"),d=t("@ta/overlays.toast"),f=t("@ta/social.blocks"),p=t("@ta/social.button"),m=t.n(p),b=t("@ta/social.feed"),g=t("@ta/social.login-gate"),w=t("@ta/tracking.interactions"),y=t("@ta/social.onboarding-state"),j=t("./packages/social/follow/AddFollow.gql"),k=t.n(j),v=t("./packages/social/follow/DeleteFollow.gql"),F=t.n(v),O=t("./packages/social/follow/FollowButton.less"),_=t.n(O),x=Object.assign||function(e){for(var o=1;o<arguments.length;o++){var t=arguments[o];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},T=function(){function e(e,o){for(var t=0;t<o.length;t++){var n=o[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(o,t,n){return t&&e(o.prototype,t),n&&e(o,n),o}}();function I(e,o,t){return o in e?Object.defineProperty(e,o,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[o]=t,e}function N(e,o){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!o||"object"!=typeof o&&"function"!=typeof o?e:o}var h=function(e){var o=e.children;return n.createElement(w.InteractionLogger,null,function(e){return n.createElement(w.FollowTabTypeContext.Consumer,null,function(t){return n.createElement(w.FollowPlacementContext.Consumer,null,function(l){return n.createElement(w.RecommendedFolloweesImpressionIdContext.Consumer,null,function(n){return o(function(o,a,i){var r={followeeId:i};l&&Object.assign(r,l),t&&Object.assign(r,t),n&&Object.assign(r,n),e(o,a,r)})})})})})},S=function(e){function o(){var e,t,l;!function(e,o){if(!(e instanceof o))throw new TypeError("Cannot call a class as a function")}(this,o);for(var a=arguments.length,c=Array(a),u=0;u<a;u++)c[u]=arguments[u];return t=l=N(this,(e=o.__proto__||Object.getPrototypeOf(o)).call.apply(e,[this].concat(c))),l.toggleFollow=function(){l.props.loginGate().then(function(){l.props.profile.isFollowing?l.props.unfollow(x({},l.props)).then(function(e){e.error||l.props.disableToast||"NO_PERMISSION"===e.data.deleteFollow.statusType&&l.props.launchToast(l.blockedToast)}):l.props.follow(x({},l.props)).then(function(e){if(!e.error){if(!l.props.disableToast)"NO_PERMISSION"===e.data.addFollow.statusType?l.props.launchToast(l.blockedToast):l.props.launchToast(l.toast);l.props.attemptOnboarding&&l.props.setFireOnboarding(!1,"FOLLOW_ACTION")}})})},l.toastDisplayNameClass=Object(i.a)(_.a.followee_display_name,I({},_.a.verified,l.props.profile.isVerified)),l.toast={iconName:"add-friend-fill",node:Object(s.unescaped)(Object(s.localize)("social_follow_toast_message",{sDisplayNameClass:l.toastDisplayNameClass,sDisplayName:Object(r.a)(l.props.profile.displayName)})),actionText:Object(s.localize)("social_unfollow"),actionCallback:l.toggleFollow},l.blockedToast={node:n.createElement(f.NoPermissionToast,null)},l.toggleAndClick=function(e){l.props.profile.isFollowing?l.props.onToggleFollow&&l.props.onToggleFollow("UNFOLLOW"):l.props.onToggleFollow&&l.props.onToggleFollow("FOLLOW"),l.toggleFollow(),l.props.onClick&&l.props.onClick(e)},N(l,t)}return function(e,o){if("function"!=typeof o&&null!==o)throw new TypeError("Super expression must either be null or a function, not "+typeof o);e.prototype=Object.create(o&&o.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),o&&(Object.setPrototypeOf?Object.setPrototypeOf(e,o):e.__proto__=o)}(o,n["Component"]),T(o,[{key:"render",value:function(){var e=this,o=this.props,t=o.displayType,l=o.profile,a=(o.loggedInUserId,o.follow,o.unfollow,function(e,o){var t={};for(var n in e)o.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}(o,["displayType","profile","loggedInUserId","follow","unfollow"])),r=l.isFollowing?"unfollow":"follow";return"plain"===t?n.createElement(h,null,function(o){return n.createElement("span",{onClick:function(t){o(t,r,l.userId),e.toggleAndClick(t)}},l.isFollowing?Object(s.localize)("social_unfollow"):Object(s.localize)("social_Follow"))}):"icon+text"===t?n.createElement(h,null,function(o){return n.createElement("span",{className:Object(i.a)(_.a.icon_text,I({},_.a.active,l.isFollowing)),onClick:function(t){o(t,r,l.userId),e.toggleAndClick(t)}},n.createElement(u.a,{name:"add-friend-fill",className:_.a.icon}),n.createElement("span",{className:Object(i.a)("ui_link",_.a.text)},l.isFollowing?Object(s.localize)("social_nowFollowing"):Object(s.localize)("social_Follow")))}):n.createElement(h,null,function(o){return n.createElement(m.a,x({},a,{type:e.props.profile.isFollowing?"primary":"secondary",onClick:function(t){o(t,r,l.userId),e.toggleAndClick(t)}}),n.createElement("span",{className:_.a.text_section},"button+icon"===t&&n.createElement(u.a,{className:_.a.icon,name:"add-friend-fill"}),n.createElement("span",{className:"button+icon"===t?_.a.text:null},e.props.profile.isFollowing?Object(s.localize)("social_nowFollowing"):Object(s.localize)("social_Follow"))))})}}]),o}();S.defaultProps={size:"fullwidth",displayType:"button",disableToast:!1,onToggleFollow:void 0,attemptOnboarding:!0};var E=Object(l.compose)(Object(a.connect)(function(e){return{loggedInUserId:e.auth.loggedInUserId}},{setFireOnboarding:y.ACTIONS.setShouldFire}),Object(l.graphql)(k.a,{props:function(e){var o=e.mutate;return{follow:function(e){var t=e.profile,n=e.loggedInUserId;return o({variables:{objectType:"MEMBER",objectId:t.userId,loggedInUserId:n},update:function(e,o){if("OK"===o.data.addFollow.statusType){var l=t.followerCount,a=void 0===l?0:l;e.writeFragment({id:"MemberProfile:"+t.userId,fragment:b.FollowerFragment,data:{id:t.userId,isFollowing:!0,followerCount:a+1,__typename:"MemberProfile"}});var i=e.readFragment({id:"MemberProfile:"+n,fragment:b.MemberFolloweeCountFragment});i&&e.writeFragment({id:"MemberProfile:"+n,fragment:b.MemberFolloweeCountFragment,data:{id:n,followeeCount:i.followeeCount+1,__typename:"MemberProfile"}})}}})}}}}),Object(l.graphql)(F.a,{props:function(e){var o=e.mutate;return{unfollow:function(e){var t=e.profile,n=e.loggedInUserId;return o({variables:{objectType:"MEMBER",objectId:t.userId,loggedInUserId:n},update:function(e,o){if("OK"===o.data.deleteFollow.statusType){var l=t.followerCount,a=void 0===l?1:l;e.writeFragment({id:"MemberProfile:"+t.userId,fragment:b.FollowerFragment,data:{id:t.userId,isFollowing:!1,followerCount:a-1,__typename:"MemberProfile"}});try{var i=e.readFragment({id:"MemberProfile:"+n,fragment:b.MemberFolloweeCountFragment});i&&i.followeeCount>0&&e.writeFragment({id:"MemberProfile:"+n,fragment:b.MemberFolloweeCountFragment,data:{id:n,followeeCount:i.followeeCount-1,__typename:"MemberProfile"}})}catch(e){}}}})}}}}))(function(e){return n.createElement(n.Fragment,null,Object(c.featureIsEnabled)("social_follow_enabled")&&n.createElement(d.Toaster,null,function(o){return n.createElement(g.SocialLoginGate,{pid:40473},function(t){return n.createElement(S,x({launchToast:o,loginGate:t},e))})}))});o.default=E},"./packages/social/follow/FollowButton.less":function(e,o,t){e.exports={icon:"social-follow-FollowButton__icon--jmBEl",text:"social-follow-FollowButton__text--1yiU0",text_section:"social-follow-FollowButton__text_section--2aGjc",icon_text:"social-follow-FollowButton__icon_text--1AEL5",active:"social-follow-FollowButton__active--16fVf",followee_display_name:"social-follow-FollowButton__followee_display_name--zjGEa",verified:"social-follow-FollowButton__verified--1kdu3"}},"./packages/styleguide/icon/Icon.jsx":function(e,o,t){"use strict";var n=t("./node_modules/react/index.js"),l=function(e){var o=e.name,t=e.className;return n.createElement("span",{className:"ui_icon "+o+" "+t})};l.defaultProps={className:""},o.a=l},"@ta/overlays.toast":function(o,t){o.exports=e},"@ta/social.blocks":function(e,t){e.exports=o},"@ta/social.button":function(e,o){e.exports=t},"@ta/social.feed":function(e,o){e.exports=n},"@ta/social.login-gate":function(e,o){e.exports=l},"@ta/social.onboarding-state":function(e,o){e.exports=a},"@ta/tracking.interactions":function(e,o){e.exports=i},"dll-reference @ta/common.global":function(e,o){e.exports=r}})});