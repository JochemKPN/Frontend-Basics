define("@ta/social.login-gate",["@ta/overlays.fullscreen-overlay","@ta/overlays.managers","@ta/overlays.pieces","@ta/platform.import","@ta/social.failover","@ta/tracking.interactions","@ta/common.global"],function(e,n,t,r,o,a,i){return function(e){var n={};function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:r})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(t.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var o in e)t.d(r,o,function(n){return e[n]}.bind(null,o));return r},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="/components/dist/",t(t.s="./packages/social/login-gate/index.jsx")}({"./node_modules/react-apollo/react-apollo.browser.umd.js":function(e,n,t){e.exports=t("dll-reference @ta/common.global")("./node_modules/react-apollo/react-apollo.browser.umd.js")},"./node_modules/react-redux/es/index.js":function(e,n,t){e.exports=t("dll-reference @ta/common.global")("./node_modules/react-redux/es/index.js")},"./node_modules/react/index.js":function(e,n,t){e.exports=t("dll-reference @ta/common.global")("./node_modules/react/index.js")},"./node_modules/webpack/buildin/global.js":function(e,n){var t;t=function(){return this}();try{t=t||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(t=window)}e.exports=t},"./packages/common/features/features.jsx":function(e,n,t){e.exports=t("dll-reference @ta/common.global")("./packages/common/features/features.jsx")},"./packages/common/logging/logging.jsx":function(e,n,t){e.exports=t("dll-reference @ta/common.global")("./packages/common/logging/logging.jsx")},"./packages/common/webview/NativeBridge.jsx":function(e,n,t){"use strict";function r(e){var n="";if(null!=e.tapCallback){var t=e.tapCallback,r="nativeInterop"+function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+e()+e()+e()+e()+e()+e()}();window[r]=function(){null!=t&&t()},n=r,e.tapFunction=n,e.tapCallback=null}}function o(){return"undefined"!=typeof window&&window.taBridgeContext?(window.bridge||window.bridge||(window.bridge=(e=[],n=0,t=[],document.addEventListener("PacificDidReceiveNativeCallback",function(n){if(n.detail){var t=n.detail,r=isNaN(parseInt(t.id))?-1:parseInt(t.id);-1!=r&&(e[r]&&e[r](t.parameters,t.error),delete e[r])}},!1),document.addEventListener("PacificDidReceiveNativeBroadcast",function(e){if(e.detail){var n=e.detail,r=n.name;if(void 0!==r&&t[r]){var o=t[r];if(o instanceof Array){var a=n.parameters;o.forEach(function(e){e(a)})}}}},!1),{post:function(t,r,o,a,i){var l=n++;e[l]=a,window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.pacific?window.webkit.messageHandlers.pacific.postMessage({action:t,parameters:r,uid:o,callback:l,print:i||0}):window.pacific&&window.pacific.postMessage(JSON.stringify({action:t,parameters:r,uid:o,callback:l,print:i||0}))},on:function(e,n){var r=t[e];return r||(t[e]=r=[]),r.push(n),function(){r[indexOf(r,n)]=null}},off:function(e){delete t[e]}})),window.taBridgeContext.uid):null;var e,n,t}function a(e,n){if("undefined"==typeof window||!window.taBridgeContext||!window.taBridgeContext.actions)return!1;var t=window.taBridgeContext.actions[e];return!(!t||!t.v)&&n===t.v}function i(e,n,t){o()&&(e?window.bridge.on(n,t):window.bridge.off(n))}function l(e){e.items.forEach(function(e,n){r(e)})}function c(e,n,t){var r=o();return!(!r||!a(e,n))&&(window.bridge.post(e,t||{},r),!0)}function s(){c("hideSkeleton",1,null)}function u(e){!function(e){null!=e.trailingMenuItems&&e.trailingMenuItems.forEach(function(e,n){var t=e;r(t),null!=t.nestedMenu&&l(t.nestedMenu)})}(e.navigation),c("onNewOrUpdatedScreen",1,e)}function f(e){l(e),c("overflowMenu",1,e)}function d(){a("map",2)?c("map",2,null):c("map",1,null)}function p(e){c("createTrip",1,{isPublic:e})}function m(e){c("shareTrip",1,e)}t.r(n),t.d(n,"isActionSupported",function(){return a}),t.d(n,"postToBridge",function(){return c}),t.d(n,"hideSkeleton",function(){return s}),t.d(n,"onNewOrUpdatedScreen",function(){return u}),t.d(n,"showNativeOverflowMenu",function(){return f}),t.d(n,"showNativeMap",function(){return d}),t.d(n,"showNativeCreateTrip",function(){return p}),t.d(n,"showNativeShareTrip",function(){return m}),t.d(n,"showSavesModal",function(){return v}),t.d(n,"showRegistration",function(){return g}),t.d(n,"close",function(){return y}),t.d(n,"startScreenTransition",function(){return b}),t.d(n,"onOverlayStateChange",function(){return w}),t.d(n,"onHeaderHeightChange",function(){return O}),t.d(n,"onShrinkMap",function(){return h}),t.d(n,"onNavigateToTripDetail",function(){return k}),t.d(n,"onHandleTripCollaboration",function(){return j}),t.d(n,"onFlushBatchTracking",function(){return _}),t.d(n,"isNativeWebview",function(){return x}),t.d(n,"getHeaderHeight",function(){return E}),t.d(n,"onTripsRefetch",function(){return S}),t.d(n,"onTripUpdate",function(){return T}),t.d(n,"onTripItemDelete",function(){return C}),t.d(n,"onRefetchTripsWithItems",function(){return P});var v=function(e){a("presentSavesModal",2)?c("presentSavesModal",2,e):c("presentSavesModal",1,{itemId:e.id})},g=function(e){c("showReg",1,{dismissOnCancellation:e})};function y(){c("close",1,null)}function b(){c("startScreenTransition",1,null)}function w(e){c(e?"overlayShown":"overlayHidden",1,null)}function O(e,n){i(e,"updateHeaderHeight",n)}function h(e,n){i(e,"shrinkMap",n)}function k(e,n){i(e,"navigateToTripDetail",n)}function j(e,n){i(e,"handleTripCollaboration",n)}function _(e,n){i(e,"flushBatchTracking",n)}function x(){return null!=o()}function E(){if("undefined"!=typeof window&&void 0!==window.localStorage&&void 0!==window.localStorage.headerHeight){var e=window.localStorage.headerHeight;return"string"==typeof e&&(e=parseInt(e,10)),e}return 0}function S(e,n){i(e,"refetchTrips",n)}function T(e){c("tripUpdate",1,e)}function C(e){c("tripItemDelete",1,e)}function P(e,n){i(e,"refetchTripsWithItems",n)}},"./packages/common/webview/webview.jsx":function(e,n,t){"use strict";var r=t("./packages/common/webview/NativeBridge.jsx");t.d(n,"a",function(){return r})},"./packages/events/keyboard-event-listener/KeyboardEventListener.jsx":function(e,n,t){"use strict";var r=t("./node_modules/react/index.js"),o=function(){function e(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(n,t,r){return t&&e(n.prototype,t),r&&e(n,r),n}}();var a=function(e){function n(e){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,n);var t=function(e,n){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!n||"object"!=typeof n&&"function"!=typeof n?e:n}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));return t.handleEvent=function(e){var n=e.key;n&&-1!==t.keyNames.indexOf(n)&&t.props.callback(e)},t.keyNames=Array.isArray(e.keyName)?e.keyName:[e.keyName],t}return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function, not "+typeof n);e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(e,n):e.__proto__=n)}(n,r["Component"]),o(n,[{key:"componentDidMount",value:function(){window.addEventListener(this.props.eventType,this.handleEvent)}},{key:"componentWillUnmount",value:function(){window.removeEventListener(this.props.eventType,this.handleEvent)}},{key:"render",value:function(){return null}}]),n}();a.defaultProps={eventType:"keydown"},n.a=a},"./packages/social/login-gate/AuthGated.jsx":function(e,n,t){"use strict";(function(e){var r=t("./node_modules/react/index.js"),o=t("./node_modules/react-redux/es/index.js"),a=t("./node_modules/react-apollo/react-apollo.browser.umd.js"),i=t("./packages/common/webview/webview.jsx"),l=t("@ta/tracking.interactions"),c=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},s=function(){function e(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(n,t,r){return t&&e(n.prototype,t),r&&e(n,r),n}}();function u(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}var f=function(n){function t(){return function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,n){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!n||"object"!=typeof n&&"function"!=typeof n?e:n}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function, not "+typeof n);e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(e,n):e.__proto__=n)}(t,r["Component"]),s(t,[{key:"formatInteraction",value:function(e){var n=this.props.tracking;return n?{variables:{interaction:u({},n.source,u({},e,c({element:n.element},n.attributes||{})))}}:null}},{key:"renderInner",value:function(n){var t=this.props,r=t.loggedInUserId,o=t.pid,a=t.flowOrigin,l=t.flow,c=t.extraQueryParams,s=t.onClose;return(0,t.children)(function(){return new Promise(function(t){if(r)t();else if(i.a.isNativeWebview())i.a.showRegistration(!1);else{var u={flow:l||"CORE_COMBINED",pid:o||-1,userRequestedForce:!0,extraQueryParams:c||{},locationId:window.require("page-model").GEO_ID,onSuccess:function(e){n("modalSuccess"),t(e)},onClose:s};a&&(u.extraQueryParams.flowOrigin=a),e.require(["trjs!ta/registration/RegOverlay"],function(e){n("elementClick"),e.showRegOverlayByPageModel(null,null,window.require("page-model"),u)})}})},r)}},{key:"render",value:function(){var e=this;return r.createElement(a.Mutation,{mutation:l.LogInteractionV4},function(n){return e.renderInner(function(t){var r=e.formatInteraction(t);r&&n(r)})})}}]),t}();n.a=Object(o.connect)(function(e,n){return c({loggedInUserId:e.auth.loggedInUserId},n)})(f)}).call(this,t("./node_modules/webpack/buildin/global.js"))},"./packages/social/login-gate/ReadonlyMessageOverlay.less":function(e,n,t){e.exports={container:"social-login-gate-ReadonlyMessageOverlay__container--2soKz",bodyContent:"social-login-gate-ReadonlyMessageOverlay__bodyContent--1Mt3g"}},"./packages/social/login-gate/TermsOfUseOverlay.less":function(e,n,t){e.exports={container:"social-login-gate-TermsOfUseOverlay__container--2cdv9",bodyContent:"social-login-gate-TermsOfUseOverlay__bodyContent--17ySl"}},"./packages/social/login-gate/TermsOverlayQuery.gql":function(e,n){var t={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"TermsOverlay"},variableDefinitions:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"insightProfile"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"uiCardsState"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"states"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"state"},arguments:[],directives:[]}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"getTermOfUseAcceptanceInfo"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"accepted"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:167}};t.loc.source={body:"query TermsOverlay {\n  insightProfile {\n    uiCardsState {\n      states {\n        id\n        state\n      }\n    }\n  }\n  getTermOfUseAcceptanceInfo {\n    accepted\n  }\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};e.exports=t},"./packages/social/login-gate/index.jsx":function(e,n,t){"use strict";t.r(n);var r=t("./node_modules/react/index.js"),o=t("./node_modules/react-redux/es/index.js"),a=t("./packages/common/features/features.jsx"),i=t("@ta/social.failover"),l=t("./packages/social/login-gate/AuthGated.jsx"),c=t("./node_modules/react-apollo/react-apollo.browser.umd.js"),s=t("./packages/common/logging/logging.jsx"),u=t.n(s),f=t("@ta/overlays.fullscreen-overlay"),d=t.n(f),p=t("@ta/overlays.managers"),m=t("@ta/overlays.pieces"),v=t("@ta/platform.import"),g=t("./packages/social/login-gate/TermsOverlayQuery.gql"),y=t.n(g),b=t("./packages/social/login-gate/TermsOfUseOverlay.less"),w=t.n(b),O=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},h={position:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)"}},k=Object(v.deferredImport)("@ta/social.confirm-username","ConfirmUsername"),j=function(e){var n=e.onComplete,t=e.children;return r.createElement(c.Query,{query:y.a},function(e){var r=e.loading,o=e.data,a=e.error;if(r)return null;if(o){var i=o.getTermOfUseAcceptanceInfo&&o.getTermOfUseAcceptanceInfo.accepted,l=o.insightProfile&&o.insightProfile.uiCardsState;return i&&l&&l.states.find(function(e){return"ONBOARDING_CONFIRM_USER"===e.id&&"COMPLETED"===e.state})?(n(),null):t}return a&&u.a.warn("Error in SkipIfCompleted query: "+a),u.a.warn("TermsOfUseOverlay was shown due to lack of sufficient information or a query error."),t})},_=function(e){var n=function(n){return r.createElement("div",{className:w.a.container},r.createElement("div",{className:w.a.bodyContent},r.createElement(k,{onComplete:e.onComplete,closerForError:n,trackingModule:"Social_onboarding_gatedaction"})))},t=function(){return r.createElement(p.Closer,null,function(t){var o=function(){t(),e.onClose&&e.onClose()};return e.fullscreen?r.createElement(r.Fragment,null,r.createElement(d.a,null,n(o))):r.createElement(r.Fragment,null,r.createElement(m.BlockScroll,null),r.createElement(m.Backdrop,{close:function(){}},r.createElement(m.Overlay,h,n(o))))})};return e.forceTermsOfUse?r.createElement(t,null):r.createElement(j,{onComplete:e.onComplete},r.createElement(t,null))};_.defaultProps={fullscreen:!1,onClose:null,forceTermsOfUse:!1};var x=Object(o.connect)(function(e,n){return O({},n,{fullscreen:n.fullscreenAlways||"MOBILE"===e.meta.device.viewportCategory})})(_),E=t("./packages/events/keyboard-event-listener/KeyboardEventListener.jsx"),S=t("./packages/social/login-gate/ReadonlyMessageOverlay.less"),T=t.n(S),C=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},P={position:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)"}},M=function(e){var n=r.createElement("div",{className:T.a.container},r.createElement("div",{className:T.a.bodyContent},e.children),r.createElement(m.CloseX,{close:e.closer}));return e.fullscreen?r.createElement(r.Fragment,null,r.createElement(d.a,null,n)):r.createElement(r.Fragment,null,r.createElement(m.BlockScroll,null),r.createElement(m.Backdrop,{close:e.closer},r.createElement(m.Overlay,P,n),r.createElement(E.a,{keyName:"Escape",callback:e.closer})))};M.defaultProps={fullscreen:!1,onClose:null};var N=Object(o.connect)(function(e,n){return C({},n,{fullscreen:n.fullscreenAlways||"MOBILE"===e.meta.device.viewportCategory})})(M),I=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},U=function(){function e(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(n,t,r){return t&&e(n.prototype,t),r&&e(n,r),n}}();function R(e,n){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!n||"object"!=typeof n&&"function"!=typeof n?e:n}var B=function(e){function n(){var e,t,r;!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,n);for(var o=arguments.length,a=Array(o),i=0;i<o;i++)a[i]=arguments[i];return t=r=R(this,(e=n.__proto__||Object.getPrototypeOf(n)).call.apply(e,[this].concat(a))),r.state={openTermsOfUseOverlay:!1,onSuccess:function(){},forceTermsOfUse:!1,openReadonlyOverlay:!1},r.closeTermsOfUseOverlay=function(){r.setState({openTermsOfUseOverlay:!1,onSuccess:function(){}})},r.openReadonlyOverlay=function(){r.setState({openReadonlyOverlay:!0})},r.closeReadonlyOverlay=function(){r.setState({openReadonlyOverlay:!1})},R(r,t)}return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function, not "+typeof n);e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(e,n):e.__proto__=n)}(n,r["Component"]),U(n,[{key:"render",value:function(){var e=this,n=this.props,t=n.pid,o=n.flowOrigin,c=n.children,s=n.onClose,u=n.tracking,f=n.isReadonlyMode;return r.createElement(l.a,{pid:t,flowOrigin:o,extraQueryParams:{social:!0},onClose:s,tracking:u},function(n,t){var o=f?function(){return e.openReadonlyOverlay(),Promise.reject()}:Object(a.featureIsEnabled)("social_2018_login_gate")?function(){return n().then(function(n){var t=n&&(n.hasCreatedMember||!n.hasAcceptedTermsOfUse);return n&&!t||Object(a.featureIsEnabled)("social_2018_login_gate_skip_terms_of_service")?Promise.resolve():new Promise(function(n){e.setState({openTermsOfUseOverlay:!0,forceTermsOfUse:t,onSuccess:function(){n(),e.setState({openTermsOfUseOverlay:!1,onSuccess:function(){}})}})})})}:function(){return Promise.resolve()};return r.createElement(r.Fragment,null,c(o,t),e.state.openTermsOfUseOverlay&&r.createElement(x,{onComplete:e.state.onSuccess,forceTermsOfUse:e.state.forceTermsOfUse,onClose:e.closeTermsOfUseOverlay}),e.state.openReadonlyOverlay&&r.createElement(N,{closer:e.closeReadonlyOverlay},r.createElement(i.FailoverMessage,null)))})}}]),n}();B.defaultProps={pid:-1,flowOrigin:void 0,tracking:void 0};var F=Object(o.connect)(function(e,n){return I({isReadonlyMode:e.meta.readonlyMode},n)})(B),A=function(e){var n=e.name,t=e.local,o=e.pid,a=e.children;return r.createElement(F,{pid:o},function(e){return r.createElement(p.Opener,{name:n,local:t},function(n,t){return a(function(){e().then(n)},t)})})};A.defaultProps={local:!1,pid:void 0};var D=A;t.d(n,"SocialLoginGate",function(){return F}),t.d(n,"TermsOfUseOverlay",function(){return x}),t.d(n,"SocialOpener",function(){return D}),t.d(n,"AuthGated",function(){return l.a}),t.d(n,"TermsOverlayQuery",function(){return y.a})},"@ta/overlays.fullscreen-overlay":function(n,t){n.exports=e},"@ta/overlays.managers":function(e,t){e.exports=n},"@ta/overlays.pieces":function(e,n){e.exports=t},"@ta/platform.import":function(e,n){e.exports=r},"@ta/social.failover":function(e,n){e.exports=o},"@ta/tracking.interactions":function(e,n){e.exports=a},"dll-reference @ta/common.global":function(e,n){e.exports=i}})});